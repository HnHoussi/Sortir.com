{% extends 'base.html.twig' %}

{% block title %}Modifier mon profil{% endblock %}

{% block body %}
    <div class="container mt-5">
        {% if app.user and app.user.id == user.id %}
            <h1 class="text-center mb-4">Modifier mon profil</h1>
        {% else %}
            <h1 class="text-center mb-4">Modification de profil</h1>
        {% endif %}

        <div class="row justify-content-center">
            <div class="col-md-8 col-lg-6">

                <form method="post">
                    {{ form_row(edit_profil_form._token) }}

                    <div class="mb-3">
                        {{ form_label(edit_profil_form.firstName) }}
                        {{ form_widget(edit_profil_form.firstName, {'attr': {'class': 'form-control'}}) }}
                    </div>

                    <div class="mb-3">
                        {{ form_label(edit_profil_form.lastName) }}
                        {{ form_widget(edit_profil_form.lastName, {'attr': {'class': 'form-control'}}) }}
                    </div>

                    <div class="mb-3">
                        {{ form_label(edit_profil_form.pseudo) }}
                        {{ form_widget(edit_profil_form.pseudo, {'attr': {'class': 'form-control'}}) }}
                    </div>

                    <div class="mb-3">
                        {{ form_label(edit_profil_form.phone) }}
                        {{ form_widget(edit_profil_form.phone, {'attr': {'class': 'form-control'}}) }}
                    </div>

                    <div class="mb-3">
                        {{ form_label(edit_profil_form.email) }}
                        {{ form_widget(edit_profil_form.email, {'attr': {'class': 'form-control'}}) }}
                    </div>

                    <div class="mb-3">
                        {{ form_label(edit_profil_form.campus) }}
                        {{ form_widget(edit_profil_form.campus, {'attr': {'class': 'form-select'}}) }}
                    </div>

                    {# Password section #}
                    {% if app.user and app.user.id == user.id %}
                        <p style="font-weight: bold" class="mt-5">Si vous voulez changer le mot de passe :</p>
                    {% endif %}

                    {% if edit_profil_form.oldPassword is defined %}
                        <div class="mb-3">
                            {{ form_label(edit_profil_form.oldPassword) }}
                            {{ form_widget(edit_profil_form.oldPassword, {
                                'attr': {
                                    'class': 'form-control' ~ (edit_profil_form.oldPassword.vars.errors|length ? ' is-invalid' : '')
                                }
                            }) }}
                            {% for error in edit_profil_form.oldPassword.vars.errors %}
                                <div class="text-danger">{{ error.message }}</div>
                            {% endfor %}
                        </div>
                    {% endif %}

                    {% if edit_profil_form.newPassword is defined %}
                        <div class="mb-3">
                            {{ form_label(edit_profil_form.newPassword.first) }}
                            {{ form_widget(edit_profil_form.newPassword.first, {'attr': {'class': 'form-control'}}) }}
                        </div>

                        <div class="mb-3">
                            {{ form_label(edit_profil_form.newPassword.second) }}
                            {{ form_widget(edit_profil_form.newPassword.second, {'attr': {'class': 'form-control'}}) }}
                        </div>
                    {% endif %}

                    <div class="mb-3 text-center">
                        <button type="submit" class="btn btn-primary">Enregistrer</button>
                        <a href="{{ path('app_user_profile') }}" class="btn btn-secondary ms-2">Annuler</a>

                    </div>

                </form>

            </div>
        </div>
    </div>
{% endblock %}
